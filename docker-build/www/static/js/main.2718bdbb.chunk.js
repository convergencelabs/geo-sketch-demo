(this["webpackJsonpgeo-sketch-demo"]=this["webpackJsonpgeo-sketch-demo"]||[]).push([[0],{105:function(e,t,n){e.exports={container:"styles_container__1KXGp",chatMessages:"styles_chatMessages__hXuqV"}},163:function(e,t,n){e.exports={mainMap:"styles_mainMap__3ErMX"}},164:function(e,t,n){e.exports={latLonWidget:"styles_latLonWidget__1HF1n"}},167:function(e,t,n){e.exports={collabTextArea:"styles_collabTextArea__yHKrp"}},172:function(e,t,n){e.exports={presenceList:"styles_presenceList__1bWZk"}},173:function(e,t,n){e.exports={chatPanel:"styles_chatPanel__1ejlL"}},175:function(e,t,n){e.exports={chatInput:"styles_chatInput__gwuQk"}},176:function(e,t,n){e.exports={title:"styles_title__2wVPV"}},177:function(e,t,n){e.exports=n(378)},182:function(e,t,n){},30:function(e,t,n){e.exports={collapsed:"styles_collapsed__ry_ET",expanded:"styles_expanded__1pWwN",expanderButton:"styles_expanderButton__3T0k7",editorWidget:"styles_editorWidget__1I-Jg",title:"styles_title__2P9ax",label:"styles_label__1VVM8",descriptionInput:"styles_descriptionInput__9_lsj",titleInput:"styles_titleInput__ahQYq"}},34:function(e,t,n){e.exports={formattingWidget:"styles_formattingWidget__1VxJ2",row:"styles_row__1XAXf",button:"styles_button__2RT-y",thickness:"styles_thickness__3TVEl"}},35:function(e,t,n){e.exports={login:"styles_login__3lYxr",title:"styles_title__3gnnm",name:"styles_name__NQ72x",label:"styles_label__EfNn2",form:"styles_form__2TyNH",buttons:"styles_buttons__3FLZg",button:"styles_button__2rpTD",note:"styles_note__2Kj7T"}},378:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(33),i=n.n(o),s=(n(182),n(8)),c=n(24),l=n(163),u=n.n(l),p=n(5),m=n.n(p),h=n(77),f=n(1),y=n(2),v=n(102),d=["esri/Basemap","esri/Color","esri/Graphic","esri/Map","esri/core/watchUtils","esri/geometry/Extent","esri/geometry/Geometry","esri/geometry/Point","esri/geometry/Polygon","esri/geometry/Polyline","esri/geometry/support/jsonUtils","esri/layers/GraphicsLayer","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleMarkerSymbol","esri/symbols/Symbol","esri/views/MapView","esri/widgets/Expand","esri/widgets/BasemapGallery","esri/widgets/Sketch"],b={},g=function(){function e(){Object(f.a)(this,e)}return Object(y.a)(e,null,[{key:"init",value:function(){var e=Object(h.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(v.loadCss)(),e.next=3,Object(v.loadModules)(d);case 3:t=e.sent,d.forEach((function(e,n){var a=e.split("/");a.shift();for(var r=b,o=0;o<a.length-1;o++){var i=a[o];void 0===r[i]&&(r[i]={}),r=r[i]}r[a[a.length-1]]=t[n]}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),_=function(e){var t=Object(a.useState)(null),n=Object(s.a)(t,2),r=n[0],o=n[1],i=e.item,c=e.layer,l=e.update,u=e.create;return Object(a.useEffect)((function(){var e=u(i);return c.add(e),o(e),function(){c.remove(e)}}),[c]),Object(a.useEffect)((function(){null!==r&&l(i,r)}),[i,r,l]),null},O=n(103),S=new O.ColorAssigner(O.ColorAssigner.Palettes.DARK_12);function w(e){var t=e.r,n=e.g,a=e.b,r=e.a,o=[t,n,a];return void 0!==r&&o.push(r),new b.Color(o)}var E=function(e){var t=e.pointer,n=e.layer;return r.a.createElement(_,{layer:n,item:t,create:j,update:function(e,t){t.geometry=new b.geometry.Point(e.value)}})};function j(e){var t=new b.geometry.Point(e.value),n=S.getColor(e.user.userId.toGuid()),a=[n.r,n.g,n.b,.7],r=new b.symbols.SimpleMarkerSymbol({style:"path",outline:{style:"none"},path:x,xoffset:"5px",yoffset:"-7px",color:a});return new b.Graphic({geometry:t,symbol:r})}var x="m 75.300095,89.125 c -2.5188,0 -5.03,0 -7.55,0.025 -0.36,57.61001 -0.14488,115.23998 -0.22504,172.85 0.11024,30.56004 -0.21968,61.12498 0.2,91.675 10.37032,-0.01 20.74008,0.08 31.1,0 0.27744,-4.44488 0.348,-8.93234 0.35008,-13.425 l 0,-2.025 2.024965,0.025 c 4.40976,0.0289 8.81048,0.002 13.2,-0.05 0.10592,-4.5143 0.42376,-9.05769 -0.075,-13.575 l -0.27496,-2.525 2.52504,0.325 c 4.54232,0.57852 9.13448,0.197 13.67496,0.1 0.0866,-4.35032 0.1844,-8.70374 0.22504,-13.05 l 0.025,-2 2,0.025 c 3.43216,0.0267 6.87392,-0.0112 10.32496,-0.2 l 2.27504,-0.125 -0.17504,2.275 c -0.71368,9.51482 0.89384,19.03621 0.37504,28.55 4.48976,0.14849 8.97896,0.2084 13.47504,0.25 l 1.94992,0.025 0.025,1.95 c 0.0878,9.64042 0.0657,19.27631 0.22504,28.925 4.4364,0.087 8.87376,0.1386 13.32496,0.15 l 1.97504,0 0.025,1.975 c 0.0801,4.49655 0.11752,8.96595 0.1,13.475 10.43992,0.14 20.88512,0.11 31.32496,0.05 0.37624,-4.42817 0.5416,-8.91848 0.22504,-13.425 l -0.15,-2.2 2.2,0.05 c 4.42952,0.12337 8.8712,0.0862 13.25,-0.025 0.15,-10.38998 0.095,-20.78495 -0.025,-31.175 -4.46072,-0.12198 -8.91296,-0.1782 -13.37496,-0.225 l -1.95,-0.025 -0.025,-1.95 c -0.15104,-9.65978 -0.078,-19.28792 -0.12504,-28.95 -4.46824,-0.1639 -8.97896,-0.24806 -13.47496,-0.125 l -2.12504,0.05 0.075,-2.125 c 0.15224,-3.72234 0.2132,-7.43125 0.2,-11.125 l 0,-2 2,0 c 19.96048,-0.0353 39.9032,-0.0274 59.87504,-0.25 0.13008,-10.35002 0.16488,-20.69997 -0.025,-31.05 -4.49024,0 -8.97256,-0.0334 -13.45008,-0.1 l -1.94992,-0.025 -0.025,-1.95 c -0.065,-4.48808 -0.10104,-8.98374 -0.075,-13.475 -4.46624,-0.1132 -8.92296,-0.1394 -13.4,-0.15 l -1.97504,0 -0.025,-1.975 c -0.0491,-4.45188 -0.088,-8.89958 -0.17504,-13.35 -4.4552,-0.199 -8.93808,-0.3182 -13.45,-0.275 l -2.02504,0.025 0,-2.025 c -0.01,-4.50767 -0.031,-9.00584 -0.075,-13.5 -4.49248,0.0263 -8.99208,-0.009 -13.47496,-0.1 l -1.95008,-0.05 0,-1.95 c -0.0118,-4.41425 -0.0446,-8.8033 -0.17496,-13.2 -4.43424,-0.243 -8.87832,-0.2822 -13.35,-0.3 l -1.97504,0 -0.025,-1.975 c -0.0707,-4.49178 -0.1176,-8.96993 -0.1,-13.475 -4.49776,-0.0175 -8.98584,-0.0518 -13.47504,-0.125 l -1.9,-0.025 -0.075,-1.9 c -0.1608,-4.49031 -0.34096,-9.00011 -0.35,-13.5 -4.38576,-0.1042 -8.76824,-0.122 -13.17504,-0.125 l -1.94992,0 -0.0501,-1.95 c -0.1088,-4.4705 -0.1688,-8.96599 -0.12496,-13.45 -4.49192,-0.0524 -8.9856,-0.0844 -13.47504,-0.15 l -1.9,-0.025 -0.075,-1.9 c -0.17592,-4.48987 -0.24096,-8.98034 -0.25,-13.5 -4.46808,-0.1045 -8.92472,-0.1282 -13.4,-0.15 l -1.97504,0 -0.025,-1.975 c -0.0282,-4.4654 -0.0543,-8.94064 -0.15,-13.4 -4.48952,-0.0262 -9.0016,-0.0375 -13.5,-0.075 l -1.950005,-0.025 -0.02496,-1.95 c -0.04112,-4.47935 -0.066,-8.97978 -0.07504,-13.475 -4.49416,-0.1306 -9.02416,-0.1016 -13.55,-0.075 l -1.97496,0 -0.02504,-1.975 c -0.0284,-4.508216 -0.10856,-9.018512 -0.3,-13.5 -2.51496,-0.015 -5.03128,-0.025 -7.55,-0.025 z",k=function(e){var t=Object(a.useState)(null),n=Object(s.a)(t,2),o=n[0],i=n[1];if(Object(a.useEffect)((function(){var t=new b.layers.GraphicsLayer;return e.map.add(t,e.map.layers.length),i(t),function(){e.map.remove(t)}}),[e.map]),null!==o){var c=e.remoteItems.map((function(t){return e.renderer(t,o)}));return r.a.createElement(a.Fragment,null,c)}return null},C=function(e){return r.a.createElement(k,{map:e.map,remoteItems:e.pointers,renderer:function(e,t){return r.a.createElement(E,{key:e.sessionId,layer:t,pointer:e})}})};function N(e,t){var n=0,a=null,r=this;return{callback:function(){var o=arguments,i=Date.now(),s=i-n;s>t?(n=i,e.apply(r,o)):(a&&(clearTimeout(a),a=null),a=setTimeout((function(){e.apply(r,o)}),t-s))},cancel:function(){clearTimeout(a)}}}var I=n(164),A=n.n(I),G=function(e){var t=e.position,n=Object(a.useRef)(null),o=function(e){return e?"".concat(P(e.y,!0),", ").concat(P(e.x,!1)):""}(t);return r.a.createElement("div",{className:A.a.latLonWidget,ref:n},o)};function P(e,t){var n=Number(e),a=Number(60*(e-n)),r=3600*(e-n-a/60),o=t?e<0?"S":"N":e<0?"W":"E";return"".concat(Math.abs(Math.round(n)),"\xb0 ").concat(Math.round(a),"' ").concat(Math.round(r),'" ').concat(o)}var L,M,T,R,D,V,F,K,U,B,J,z,H,W,q,Q,X,Y=n(3),Z=n(4),$=n(76),ee=n(14),te=n(12),ne=(n(51),n(11)),ae=n(6),re=function e(t,n,a){Object(f.a)(this,e),this.user=t,this.sessionId=n,this.value=a,Object.freeze(this)},oe=(L=function(){function e(t,n){var a=this;Object(f.a)(this,e),Object(ee.a)(this,"remoteStateMap",M,this),Object(ee.a)(this,"localState",T,this),this._defaultLocalState=void 0,this._stateKey=void 0,this._activity=null,this._onUpdateState=function(e){if(null!==a._activity){var t=a._activity.participant(e.sessionId);if(!t.local&&t.state.has(a._stateKey)){var n=a._createModel(t);a.setRemoteState(e.sessionId,n)}}},this._onRemoveState=function(e){a.remoteStateMap.delete(e.sessionId)},this._stateKey=t,this.remoteStateMap=new Map,this.localState=n,this._defaultLocalState=n}return Object(y.a)(e,[{key:"setActivity",value:function(e){var t=this;this._activity=e,this._activity.participants().filter((function(e){return!e.local&&e.state.has(t._stateKey)})).forEach((function(e){t.remoteStateMap.set(e.sessionId,t._createModel(e))})),this._activity.events().subscribe((function(e){e instanceof ne.d&&e.key===t._stateKey?t._onUpdateState(e):e instanceof ne.c&&e.key===t._stateKey?t._onRemoveState(e):e instanceof ne.a?t._onUpdateState(e):e instanceof ne.b&&t._onRemoveState(e)})),this.localState&&this.setLocalState(this.localState)}},{key:"setLocalState",value:function(e){this.localState=e,null!==this._activity&&this._activity.setState(Object($.a)({},this._stateKey,e))}},{key:"clearLocalState",value:function(){this.localState=this._defaultLocalState,null!==this._activity&&this._activity.removeState(this._stateKey)}},{key:"setRemoteState",value:function(e,t){this.remoteStateMap.set(e,t)}},{key:"_createModel",value:function(e){var t=e.state.get(this._stateKey);return new re(e.user,e.sessionId,t)}},{key:"remoteState",get:function(){return Array.from(this.remoteStateMap.values())}}]),e}(),M=Object(te.a)(L.prototype,"remoteStateMap",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=Object(te.a)(L.prototype,"localState",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(te.a)(L.prototype,"setActivity",[ae.action],Object.getOwnPropertyDescriptor(L.prototype,"setActivity"),L.prototype),Object(te.a)(L.prototype,"remoteState",[ae.computed],Object.getOwnPropertyDescriptor(L.prototype,"remoteState"),L.prototype),Object(te.a)(L.prototype,"setLocalState",[ae.action],Object.getOwnPropertyDescriptor(L.prototype,"setLocalState"),L.prototype),Object(te.a)(L.prototype,"clearLocalState",[ae.action],Object.getOwnPropertyDescriptor(L.prototype,"clearLocalState"),L.prototype),Object(te.a)(L.prototype,"setRemoteState",[ae.action],Object.getOwnPropertyDescriptor(L.prototype,"setRemoteState"),L.prototype),L),ie=function(e){Object(Y.a)(n,e);var t=Object(Z.a)(n);function n(){return Object(f.a)(this,n),t.call(this,"pointer",null)}return n}(oe),se=n(28),ce=function e(t,n,a){Object(f.a)(this,e),this.user=t,this.sessionId=n,this.objects=a,Object.freeze(this)},le=(R=function(){function e(){Object(f.a)(this,e),this._selectionReference=null,Object(ee.a)(this,"model",D,this),Object(ee.a)(this,"remoteSelectionMap",V,this),Object(ee.a)(this,"remoteSelections",F,this)}return Object(y.a)(e,[{key:"setRemoteSelection",value:function(e,t){var n;this.remoteSelectionMap.set(e,t),this.remoteSelections.length=0,(n=this.remoteSelections).push.apply(n,Object(se.a)(Array.from(this.remoteSelectionMap.values())))}},{key:"removeRemoteSelection",value:function(e){var t;this.remoteSelectionMap.delete(e),this.remoteSelections.length=0,(t=this.remoteSelections).push.apply(t,Object(se.a)(Array.from(this.remoteSelectionMap.values())))}},{key:"setModel",value:function(e){var t=this;this.model=e,this._selectionReference=this.model.elementReference("selection"),this._selectionReference.set([]),this._selectionReference.share(),this.model.events().subscribe((function(e){e instanceof ne.r&&"selection"===e.reference.key()&&t._handleNewReference(e.reference)})),e.references({key:"selection"}).forEach((function(e){t._handleNewReference(e)}))}},{key:"setLocalSelection",value:function(e){var t;this._selectionReference&&(null===(t=this._selectionReference)||void 0===t||t.set(e))}},{key:"_setReference",value:function(e){var t=e.values(),n=new ce(e.user(),e.sessionId(),t);this.setRemoteSelection(e.sessionId(),n)}},{key:"_handleNewReference",value:function(e){var t=this;if(!e.isLocal()){var n=e.events().subscribe((function(a){a instanceof ne.q&&a.src instanceof ne.j?t._setReference(e):a instanceof ne.o?t.removeRemoteSelection(a.src.sessionId()):a instanceof ne.p&&(t.removeRemoteSelection(a.src.sessionId()),n.unsubscribe())}));e.isSet()&&this._setReference(e)}}}]),e}(),D=Object(te.a)(R.prototype,"model",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=Object(te.a)(R.prototype,"remoteSelectionMap",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),F=Object(te.a)(R.prototype,"remoteSelections",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(te.a)(R.prototype,"setRemoteSelection",[ae.action],Object.getOwnPropertyDescriptor(R.prototype,"setRemoteSelection"),R.prototype),Object(te.a)(R.prototype,"removeRemoteSelection",[ae.action],Object.getOwnPropertyDescriptor(R.prototype,"removeRemoteSelection"),R.prototype),Object(te.a)(R.prototype,"setModel",[ae.action],Object.getOwnPropertyDescriptor(R.prototype,"setModel"),R.prototype),Object(te.a)(R.prototype,"setLocalSelection",[ae.action],Object.getOwnPropertyDescriptor(R.prototype,"setLocalSelection"),R.prototype),R),ue=function(e){Object(Y.a)(n,e);var t=Object(Z.a)(n);function n(){return Object(f.a)(this,n),t.call(this,"viewport",null)}return n}(oe),pe=function e(t,n,a){Object(f.a)(this,e),this.user=t,this.sessionId=n,this.local=a,Object.freeze(this)},me=(K=function(){function e(){Object(f.a)(this,e),this._activity=null,Object(ee.a)(this,"participants",U,this),Object(ee.a)(this,"participantAction",B,this)}return Object(y.a)(e,[{key:"setActivity",value:function(e){var t=this;this._activity=e,this._activity.participants().forEach((function(e){return t.participantJoined(e)})),this._activity.events().subscribe((function(e){e instanceof ne.a?t.participantJoined(e.participant):e instanceof ne.b&&t.participantLeft(e.sessionId)}))}},{key:"setParticipantAction",value:function(e){this.participantAction=e}},{key:"participantJoined",value:function(e){var t=new pe(e.user,e.sessionId,e.local);this.participants.set(t.sessionId,t)}},{key:"participantLeft",value:function(e){this.participants.delete(e),null!==this.participantAction&&this.participantAction.participant.sessionId===e&&(this.participantAction=null)}}]),e}(),U=Object(te.a)(K.prototype,"participants",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),B=Object(te.a)(K.prototype,"participantAction",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(te.a)(K.prototype,"setActivity",[ae.action],Object.getOwnPropertyDescriptor(K.prototype,"setActivity"),K.prototype),Object(te.a)(K.prototype,"setParticipantAction",[ae.action],Object.getOwnPropertyDescriptor(K.prototype,"setParticipantAction"),K.prototype),Object(te.a)(K.prototype,"participantJoined",[ae.action],Object.getOwnPropertyDescriptor(K.prototype,"participantJoined"),K.prototype),Object(te.a)(K.prototype,"participantLeft",[ae.action],Object.getOwnPropertyDescriptor(K.prototype,"participantLeft"),K.prototype),K),he=function e(t,n,a,r){Object(f.a)(this,e),this.user=t,this.eventId=n,this.timestamp=a,this.message=r,Object.freeze(this)},fe=(J=function(){function e(){Object(f.a)(this,e),this._room=null,Object(ee.a)(this,"messages",z,this)}return Object(y.a)(e,[{key:"setChatRoom",value:function(e){var t=this;this._room=e,this._room.getHistory({limit:25,forward:!1,eventFilter:["message"]}).then((function(e){e.data.forEach((function(e){return t.prependHistoryEntry(e)}))})),this._room.events().subscribe((function(e){e instanceof ne.h&&t.appendChatMessage(new he(e.user,e.eventNumber,e.timestamp,e.message))}))}},{key:"appendChatMessage",value:function(e){this.messages.push(e)}},{key:"prependHistoryEntry",value:function(e){e instanceof ne.l&&this.messages.unshift(new he(e.user,e.eventNumber,e.timestamp,e.message))}},{key:"sedMessage",value:function(e){this._room&&this._room.send(e).catch((function(e){return console.error()}))}}]),e}(),z=Object(te.a)(J.prototype,"messages",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(te.a)(J.prototype,"setChatRoom",[ae.action],Object.getOwnPropertyDescriptor(J.prototype,"setChatRoom"),J.prototype),Object(te.a)(J.prototype,"appendChatMessage",[ae.action],Object.getOwnPropertyDescriptor(J.prototype,"appendChatMessage"),J.prototype),Object(te.a)(J.prototype,"prependHistoryEntry",[ae.action],Object.getOwnPropertyDescriptor(J.prototype,"prependHistoryEntry"),J.prototype),Object(te.a)(J.prototype,"sedMessage",[ae.action],Object.getOwnPropertyDescriptor(J.prototype,"sedMessage"),J.prototype),J),ye=function(e){Object(Y.a)(n,e);var t=Object(Z.a)(n);function n(e){return Object(f.a)(this,n),t.call(this,"basemap","f81bc478e12c4f1691d0d7ab6361f5a6")}return n}(oe),ve=function(){function e(t){var n=this;if(Object(f.a)(this,e),this._onTransform=void 0,this._onVertexChange=void 0,this._graphic=void 0,this._rtGraphic=void 0,this._rtGeometry=void 0,this._lineSymbol=void 0,this._rtLineSymbol=void 0,this._fillSymbol=void 0,this._rtFillSymbol=void 0,this._rtTitle=void 0,this._rtDescription=void 0,this._segmentKey=void 0,this._id=void 0,this._id=t.id,this._graphic=t.graphic,this._rtGraphic=t.realTimeObject,this._onTransform=t.onTransform,this._onVertexChange=t.onVertexChange,this._graphic.symbol.outline?(this._fillSymbol=this._graphic.symbol,this._rtFillSymbol=this._rtGraphic.get("symbol"),this._bindSymbol(this._fillSymbol,this._rtFillSymbol),this._lineSymbol=this._fillSymbol.outline,this._rtLineSymbol=this._rtGraphic.elementAt(["symbol","outline"]),this._bindSymbol(this._lineSymbol,this._rtLineSymbol)):(this._fillSymbol=null,this._lineSymbol=this._graphic.symbol,this._rtLineSymbol=this._rtGraphic.get("symbol"),this._bindSymbol(this._lineSymbol,this._rtLineSymbol)),this._rtGraphic.on(ne.n.Events.DETACHED,(function(){t.onRemove(n._graphic)})),this._rtGeometry=this._rtGraphic.get("geometry"),this._rtGeometry.hasKey("rings"))this._segmentKey="rings",this._bindToPoly("rings");else if(this._rtGeometry.hasKey("paths"))this._segmentKey="paths",this._bindToPoly("paths");else{if(!this._rtGeometry.hasKey("x"))throw Error();this._segmentKey=null,this._bindToPoint()}this._rtDescription=this._rtGraphic.elementAt(["attributes","description"]),this._rtTitle=this._rtGraphic.elementAt(["attributes","title"])}return Object(y.a)(e,null,[{key:"bind",value:function(t){t.graphic.__convergenceAdapter=new e(t),t.realTimeObject.__convergenceAdapter=t.graphic.__convergenceAdapter}},{key:"getAdapter",value:function(e){return e.__convergenceAdapter}},{key:"getAdapterFromRealTimeObject",value:function(e){return e.__convergenceAdapter}}]),Object(y.a)(e,[{key:"id",value:function(){return this._id}},{key:"getRealTimeObject",value:function(){return this._rtGraphic}},{key:"getDescriptionAttribute",value:function(){return this._rtDescription}},{key:"getTitleAttribute",value:function(){return this._rtTitle}},{key:"getGraphic",value:function(){return this._graphic}},{key:"getSymbol",value:function(){return this._fillSymbol||this._lineSymbol}},{key:"_bindToPoint",value:function(){var e=this,t=this._rtGeometry.get("x");t.on(ne.m.Events.VALUE,(function(){e._graphic.geometry.x=t.value()}));var n=this._rtGeometry.get("y");n.on(ne.m.Events.VALUE,(function(){e._graphic.geometry.y=n.value()}))}},{key:"_bindToPoly",value:function(e){var t=this,n=this._rtGeometry.get(e);n.on(ne.n.Events.VALUE,(function(){t._onTransform&&t._onTransform(t._graphic);var e=n.toJSON(),a=t._graphic.geometry.toJSON();a[t._segmentKey]=e,t._graphic.geometry=b.geometry.support.jsonUtils.fromJSON(a)})),n.on(ne.n.Events.MODEL_CHANGED,(function(e){var n=e,a=n.childEvent;if(2===n.relativePath.length&&a instanceof ne.g){var r=t._graphic.geometry,o=Object(s.a)(n.relativePath,2),i=o[0],c=o[1],l=a.element.value(),u=new b.geometry.Point({x:l[0],y:l[1]});r.setPoint(i,c,u),t._graphic.geometry=b.geometry.support.jsonUtils.fromJSON(r.toJSON())}else if(1===n.relativePath.length&&a instanceof ne.e){var p=t._graphic.geometry,m=n.relativePath[0],h=a.value.value(),f=new b.geometry.Point({x:h[0],y:h[1]});p.insertPoint(m,a.index,f),t._graphic.geometry=b.geometry.support.jsonUtils.fromJSON(p.toJSON())}else if(1===n.relativePath.length&&a instanceof ne.f){var y=t._graphic.geometry,v=n.relativePath[0];y.removePoint(v,a.index),t._graphic.geometry=b.geometry.support.jsonUtils.fromJSON(y.toJSON())}void 0!==t._onVertexChange&&t._onVertexChange(t._graphic)}))}},{key:"setFillColor",value:function(e){if(!this._fillSymbol||!this._rtFillSymbol)throw new Error("This graphic does not have a fill symbol");var t=this._rtFillSymbol.get("color");this._setColor(this._fillSymbol,t,e)}},{key:"setLineColor",value:function(e){var t=this._rtLineSymbol.get("color");this._setColor(this._lineSymbol,t,e)}},{key:"setLineThickness",value:function(e){this._lineSymbol.width=e,this._rtLineSymbol.get("width").value(e)}},{key:"addVertices",value:function(e){var t=this;this._rtGeometry.model().startBatch(),e.forEach((function(e){t._rtGraphic.elementAt(["geometry",t._segmentKey,e.segmentIndex]).insert(e.pointIndex,[e.point.x,e.point.y])})),this._rtGeometry.model().completeBatch()}},{key:"deleteVertices",value:function(e){var t=this;this._rtGeometry.model().startBatch(),e.forEach((function(e){t._rtGraphic.elementAt(["geometry",t._segmentKey,e.segmentIndex]).remove(e.pointIndex)})),this._rtGeometry.model().completeBatch()}},{key:"_getSegments",value:function(){return"polygon"===this._graphic.geometry.type?this._graphic.geometry.rings:this._graphic.geometry.paths}},{key:"updateVertex",value:function(e,t,n){var a=this._segmentKey,r=this._graphic.geometry;n=n||r.getPoint(e,t);var o=this._rtGraphic.elementAt(["geometry",a,e,t]),i=this._getSegments()[e];if("polygon"===this._graphic.geometry.type&&t===i.length-1)this._rtGeometry.model().startBatch(),o.value([n.x,n.y]),r.setPoint(e,i.length-1,new b.geometry.Point(n)),this._rtGraphic.elementAt(["geometry",a,e,0]).value([n.x,n.y]),r.setPoint(e,0,new b.geometry.Point(n)),this._rtGeometry.model().completeBatch();else if("polygon"===this._graphic.geometry.type&&0===t){this._rtGeometry.model().startBatch(),o.value([n.x,n.y]),r.setPoint(e,0,new b.geometry.Point(n)),this._rtGraphic.elementAt(["geometry",a,e,i.length-1]).value([n.x,n.y]),r.setPoint(e,i.length-1,new b.geometry.Point(n)),this._rtGeometry.model().completeBatch()}else o.value([n.x,n.y]),r.setPoint(e,t,new b.geometry.Point(n))}},{key:"setGeometry",value:function(e){var t=this._rtGraphic.get("geometry");switch(e.type){case"point":this._rtGraphic.model().startBatch();var n=e;t.get("x").value(n.x),t.get("y").value(n.y),this._rtGraphic.model().completeBatch();break;case"polygon":t.get("rings").value(e.toJSON().rings);break;case"polyline":t.get("paths").value(e.toJSON().paths);break;case"multipoint":case"extent":throw new Error("unsupported geometry type: "+e.type)}}},{key:"remove",value:function(){this._rtGraphic.removeFromParent()}},{key:"_bindSymbol",value:function(e,t){var n=this;t.get("color").on(ne.n.Events.VALUE,(function(t){var a=t;e.color=n._toEsriColor(a.element);var r=n._graphic.symbol;n._graphic.symbol=b.symbols.Symbol.fromJSON({}),n._graphic.symbol=r})),t.hasKey("width")&&t.get("width").on(ne.m.Events.VALUE,(function(t){var a=t;e.width=a.element.value();var r=n._graphic.symbol;n._graphic.symbol=b.symbols.Symbol.fromJSON({}),n._graphic.symbol=r}))}},{key:"_setColor",value:function(e,t,n){var a=[n.r,n.g,n.b,255*(void 0===n.a?1:n.a)];e.color=new b.Color(a),t.value(a)}},{key:"_toEsriColor",value:function(e){var t=e.value();return new b.Color(t)}}]),e}(),de=(H=function(){function e(){Object(f.a)(this,e),Object(ee.a)(this,"lineThickness",W,this),Object(ee.a)(this,"fillColor",q,this),Object(ee.a)(this,"lineColor",Q,this),Object(ee.a)(this,"graphics",X,this)}return Object(y.a)(e,[{key:"setSelectedGraphics",value:function(e){if(this.graphics=e,1===e.length){var t=e[0],n=ve.getAdapter(t).getRealTimeObject().get("symbol"),a=n.get("color").value(),r=Object(s.a)(a,4),o=r[0],i=r[1],c=r[2],l=r[3];if(this.fillColor={r:o,g:i,b:c,a:l/255},n.hasKey("outline")){var u=n.get("outline");this.lineThickness=u.get("width").value();var p=u.get("color").value(),m=Object(s.a)(p,4),h=m[0],f=m[1],y=m[2],v=m[3];this.lineColor={r:h,g:f,b:y,a:v/255}}}}},{key:"setLineThickness",value:function(e){this.lineThickness=e}},{key:"setLineColor",value:function(e){this.lineColor=e}},{key:"setFillColor",value:function(e){this.fillColor=e}}]),e}(),W=Object(te.a)(H.prototype,"lineThickness",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),q=Object(te.a)(H.prototype,"fillColor",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{r:0,g:0,b:0,a:.25}}}),Q=Object(te.a)(H.prototype,"lineColor",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{r:0,g:0,b:0,a:1}}}),X=Object(te.a)(H.prototype,"graphics",[ae.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(te.a)(H.prototype,"setSelectedGraphics",[ae.action],Object.getOwnPropertyDescriptor(H.prototype,"setSelectedGraphics"),H.prototype),Object(te.a)(H.prototype,"setLineThickness",[ae.action],Object.getOwnPropertyDescriptor(H.prototype,"setLineThickness"),H.prototype),Object(te.a)(H.prototype,"setLineColor",[ae.action],Object.getOwnPropertyDescriptor(H.prototype,"setLineColor"),H.prototype),Object(te.a)(H.prototype,"setFillColor",[ae.action],Object.getOwnPropertyDescriptor(H.prototype,"setFillColor"),H.prototype),H),be=function(e){Object(Y.a)(n,e);var t=Object(Z.a)(n);function n(){return Object(f.a)(this,n),t.call(this,"sketch",null)}return n}(oe),ge=new ie,_e=new ue,Oe=new ye("f81bc478e12c4f1691d0d7ab6361f5a6"),Se=new le,we=new me,Ee=new fe,je=new de,xe=new be,ke=r.a.createContext({viewportStore:_e,pointerStore:ge,sketchStore:xe,basemapStore:Oe,modelStore:Se,participantStore:we,chatStore:Ee,formattingStore:je}),Ce=function(){return r.a.useContext(ke)};function Ne(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}var Ie,Ae=function(e){var t=Ce(),n=t.modelStore,r=t.formattingStore,o=t.sketchStore,i=e.view,s=n.model;return Object(a.useEffect)((function(){var e,t;if(null!==s&&i){e=new b.layers.GraphicsLayer,i.map.add(e),t=new b.widgets.Sketch({layer:e,view:i,creationMode:"update"}),i.ui.add(t,"top-right");var a=function(e,n,a,r){ve.bind({graphic:n,realTimeObject:r,id:a,onTransform:function(e){t.updateGraphics.includes(e)&&t.viewModel.activeComponent&&t.viewModel.activeComponent.refresh()},onVertexChange:function(e){t.updateGraphics.includes(e)&&t.viewModel.activeComponent&&t.viewModel.activeComponent.refresh()},onRemove:function(n){if(e.remove(n),t.updateGraphics.includes(n))if(t.updateGraphics.remove(n),t.updateGraphics.length>0&&t.viewModel.activeComponent){var a=t.viewModel.activeComponent;a.graphics=a.graphics.filter((function(e){return e!==n})),a.refresh()}else t.cancel()}})},c=function(e,t,n){var r=b.Graphic.fromJSON(e.toJSON());a(n,r,t,e),n.add(r)},l=N((function(e){o.setLocalState(e)}),50).callback,u=s.elementAt("features");u.forEach((function(t,n){c(t,n,e)})),u.on(ne.n.Events.SET,(function(t){var n=t.value,a=n.path(),r=a[a.length-1];c(n,r,e)})),t.on("create",(function(t){if("complete"!==t.state&&"cancel"!==t.state||o.clearLocalState(),"complete"===t.state){var n=t.graphic;if(n.symbol.color=w(r.fillColor),void 0!==n.symbol.outline){var i=n.symbol.outline;i.color=w(r.lineColor),i.width=r.lineThickness}var s=n.toJSON();delete s.popupTemplate,s.attributes={title:"",description:""};var c=Ne(),p=u.set(c,s);a(e,n,c,p)}else if("active"===t.state){var m=t.graphic.geometry.toJSON();l(m)}})),t.on("delete",(function(e){e.graphics.forEach((function(e){ve.getAdapter(e).remove()}))})),t.on("undo",(function(e){"move"!==e.tool&&"reshape"!==e.tool&&"transform"!==e.tool||e.graphics.forEach((function(e){ve.getAdapter(e).setGeometry(e.geometry)}))})),t.on("redo",(function(e){"move"!==e.tool&&"reshape"!==e.tool&&"transform"!==e.tool||e.graphics.forEach((function(e){ve.getAdapter(e).setGeometry(e.geometry)}))})),t.on("update",(function(e){if("active"===e.state)switch(e.toolEventInfo.type){case"move":case"rotate":case"scale":e.graphics.forEach((function(e){ve.getAdapter(e).setGeometry(e.geometry)}));break;case"reshape":var t=e.toolEventInfo.mover,n=t.attributes.pathIndex,a=t.attributes.pointIndex,r=e.graphics[0],o=r.geometry,i=(o.rings||o.paths)[n][a];ve.getAdapter(r).updateVertex(n,a,{x:i[0],y:i[1]});break;case"vertex-add":var s=e.toolEventInfo.vertices.map((function(e){var t=e.coordinates;return{segmentIndex:e.componentIndex,pointIndex:e.vertexIndex,point:{x:t[0],y:t[1]}}}));ve.getAdapter(e.graphics[0]).addVertices(s);break;case"vertex-remove":var c=e.toolEventInfo.vertices.map((function(e){return{segmentIndex:e.componentIndex,pointIndex:e.vertexIndex}}));ve.getAdapter(e.graphics[0]).deleteVertices(c)}})),t.updateGraphics.on("change",(function(){var e=t.updateGraphics.toArray();r.setSelectedGraphics(e);var a=e.map((function(e){return ve.getAdapter(e).getRealTimeObject()}));n.setLocalSelection(a)}))}return function(){i.map&&e&&i.map.remove(e),i.ui&&t&&i.ui.remove(t)}}),[i]),null},Ge=n(18);!function(e){e[e.PREVIEW=0]="PREVIEW",e[e.GOTO=1]="GOTO",e[e.LINK=2]="LINK"}(Ie||(Ie={}));var Pe=function(){function e(t,n){Object(f.a)(this,e),this.actionType=t,this.participant=n,Object.freeze(this)}return Object(y.a)(e,null,[{key:"preview",value:function(t){return new e(Ie.PREVIEW,t)}},{key:"goto",value:function(t){return new e(Ie.GOTO,t)}},{key:"link",value:function(t){return new e(Ie.LINK,t)}}]),e}();function Le(e,t,n,a,r){var o=t.getPoint(0,n),i=e.toScreen(o),s=e.toMap({x:i.x+a,y:i.y+r});t.setPoint(0,n,s)}function Me(e,t,n){var a=b.geometry.Polygon.fromExtent(e.geometry.extent);return Le(n,a,0,-t,t),Le(n,a,1,-t,-t),Le(n,a,2,t,-t),Le(n,a,3,t,t),Le(n,a,4,-t,t),a}var Te=function(e){var t=e.layer,n=e.graphic,r=e.color,o=e.mapView;return Object(a.useEffect)((function(){var a,i,s=null;if(null!==n.geometry.extent){var c=Me(n,5,o),l={type:"simple-fill",color:[r.r,r.g,r.b,.1],outline:{type:"simple-line",color:[r.r,r.g,r.b],width:1,style:"short-dot"}};s=new b.Graphic({geometry:c,symbol:l}),t.add(s),a=b.core.watchUtils.watch(n,"geometry",(function(){s&&(s.geometry=Me(n,5,o))})),i=b.core.watchUtils.watch(e.mapView,"zoom",(function(){s&&(s.geometry=Me(n,5,o))}))}return function(){s&&t.remove(s),a&&a.remove(),i&&i.remove()}}),[]),null},Re=function(e){var t=e.remoteSelection.objects.map((function(t){var n=ve.getAdapterFromRealTimeObject(t),a=S.getColor(e.remoteSelection.user.userId.toGuid());return r.a.createElement(Te,{key:n.id(),color:a,graphic:n.getGraphic(),layer:e.layer,mapView:e.mapView})}));return r.a.createElement(r.a.Fragment,null,t)},De=Object(Ge.a)((function(e){var t=Object(a.useState)(null),n=Object(s.a)(t,2),o=n[0],i=n[1],c=Ce().modelStore,l=e.mapView.map;if(Object(a.useEffect)((function(){var e=new b.layers.GraphicsLayer;return l.add(e,l.layers.length),i(e),function(){l.remove(e)}}),[l]),null!==o){var u=c.remoteSelections.map((function(t){return r.a.createElement(Re,{key:t.sessionId,remoteSelection:t,layer:o,mapView:e.mapView})}));return r.a.createElement(a.Fragment,null,u)}return null})),Ve=function(e){var t=e.view;return Object(a.useEffect)((function(){var e=new b.widgets.BasemapGallery({view:t,container:document.createElement("div")}),n=new b.widgets.Expand({view:t,content:e});return e.watch("activeBasemap",(function(e){n.collapse()})),t.ui.add(n,"top-left"),function(){t.ui.remove(n)}}),[]),null},Fe=n(34),Ke=n.n(Fe),Ue=n(20),Be=n(19),Je=n(46),ze=n.n(Je),He=n(166),We=function(e){var t=Object(a.useState)(!1),n=Object(s.a)(t,2),o=n[0],i=n[1],c=e.color,l=e.onChange,u={background:"rgba(".concat(c.r,", ").concat(c.g,", ").concat(c.b,", ").concat(c.a,")")};return r.a.createElement("div",{className:ze.a.picker},r.a.createElement("div",{className:ze.a.swatch,onClick:function(){i(!o)}},r.a.createElement("span",{className:ze.a.color,style:u})),o?r.a.createElement("div",{className:ze.a.popover},r.a.createElement("div",{className:ze.a.cover,onClick:function(){i(!1)}}),r.a.createElement(He.ChromePicker,{color:c,onChange:function(e){l(e.rgb)}})):null)},qe=Object(Ge.a)((function(){var e=Ce().formattingStore;return r.a.createElement("div",{className:Ke.a.formattingWidget},r.a.createElement("div",{className:Ke.a.row},r.a.createElement("span",{className:Ke.a.button},r.a.createElement(Be.a,{icon:Ue.f})),r.a.createElement(We,{onChange:function(t){e.setFillColor(t),e.graphics.forEach((function(e){ve.getAdapter(e).setFillColor(t)}))},color:e.fillColor})),r.a.createElement("div",{className:Ke.a.row},r.a.createElement("span",{className:Ke.a.button},r.a.createElement(Be.a,{icon:Ue.j})),r.a.createElement(We,{onChange:function(t){e.setLineColor(t),e.graphics.forEach((function(e){ve.getAdapter(e).setLineColor(t)}))},color:e.lineColor})),r.a.createElement("div",{className:Ke.a.row},r.a.createElement("span",{className:Ke.a.button},r.a.createElement(Be.a,{icon:Ue.g})),r.a.createElement("input",{className:Ke.a.thickness,type:"number",min:0,value:e.lineThickness,onChange:function(t){var n=Number(t.target.value);e.setLineThickness(n),e.graphics.forEach((function(e){ve.getAdapter(e).setLineThickness(n)}))}})))})),Qe=n(30),Xe=n.n(Qe),Ye=(n(369),n(167)),Ze=n.n(Ye),$e=n(168),et=function(e){var t=Object(a.useRef)(null),n=e.stringModel;return Object(a.useEffect)((function(){var a=n.rangeReference("selection"),r=t.current;r.value=e.stringModel.value(),r.selectionStart=0,r.selectionEnd=0,r.addEventListener("blur",(function(){a.isShared()&&a.unshare()})),r.addEventListener("focus",(function(){i(),a.isShared()||a.share()}));var o=new $e.CollaborativeTextArea({control:r,onInsert:function(e,t){return n.insert(e,t)},onDelete:function(e,t){return n.remove(e,t)},onSelectionChanged:i});function i(){var e=o.selectionManager().getSelection();a.set({start:e.anchor,end:e.target})}var s=function(e){var t=S.getColorAsHex(e.user().userId.toGuid()),n=e.value(),a=o.selectionManager();a.addCollaborator(e.sessionId(),e.user().displayName,t,{anchor:n.start,target:n.end}),e.on("cleared",(function(){return a.removeCollaborator(e.sessionId())})),e.on("disposed",(function(){return a.removeCollaborator(e.sessionId())})),e.on("set",(function(t){if(t instanceof ne.q){var n=e.value(),r=a.getCollaborator(e.sessionId());r.setSelection({anchor:n.start,target:n.end}),t.synthetic||r.flashCursorToolTip(2)}}))},c=n.events().subscribe((function(e){e instanceof ne.s?o.insertText(e.index,e.value):e instanceof ne.t&&o.deleteText(e.index,e.value.length)}));n.references({key:"selection"}).forEach((function(e){e.isLocal()||s(e)})),i();var l=n.events().subscribe((function(e){e instanceof ne.r&&"selection"===e.reference.key()&&s(e.reference)}));return function(){a.isDisposed()||a.dispose(),l.unsubscribe(),c.unsubscribe()}}),[n]),r.a.createElement("textarea",{className:Ze.a.collabTextArea,ref:t})},tt=Object(Ge.a)((function(){var e=Ce().formattingStore,t=Object(a.useState)(!1),n=Object(s.a)(t,2),o=n[0],i=n[1];if(1===e.graphics.length){var c=e.graphics[0],l=ve.getAdapter(c),u=l.getDescriptionAttribute(),p=l.getTitleAttribute(),m=o?Ue.a:Ue.b,h=o?Xe.a.expanded:Xe.a.collapsed;return r.a.createElement("div",{className:h},r.a.createElement("div",{className:Xe.a.expanderButton,onClick:function(){i(!o)}},r.a.createElement(Be.a,{icon:m})),r.a.createElement("div",{className:Xe.a.editorWidget},r.a.createElement("div",{className:Xe.a.title},"Edit Feature Details"),r.a.createElement("div",{className:Xe.a.titleInput},r.a.createElement("div",{className:Xe.a.label},"Title"),r.a.createElement(et,{stringModel:p,onChange:function(e){c.setAttribute("title",e)}})),r.a.createElement("div",{className:Xe.a.descriptionInput},r.a.createElement("div",{className:Xe.a.label},"Description"),r.a.createElement(et,{stringModel:u,onChange:function(e){c.setAttribute("description",e)}}))))}return null})),nt=function(e){var t=e.pointer,n=e.layer;return r.a.createElement(_,{layer:n,item:t,create:at,update:function(e,t){t.geometry=b.geometry.support.jsonUtils.fromJSON(e.value)}})};function at(e){var t,n=b.geometry.support.jsonUtils.fromJSON(e.value),a=S.getColor(e.user.userId.toGuid()),r=a.r,o=a.g,i=a.b,s=new b.symbols.SimpleLineSymbol({width:1,color:[r,o,i,.7]});return t="polyline"===n.type?s:new b.symbols.SimpleFillSymbol({outline:s,color:[r,o,i,.25]}),new b.Graphic({geometry:n,symbol:t})}var rt=function(e){return r.a.createElement(k,{map:e.map,remoteItems:e.sketches,renderer:function(e,t){return r.a.createElement(nt,{key:e.sessionId,layer:t,pointer:e})}})},ot=Object(Ge.a)((function(){var e=Ce(),t=e.pointerStore,n=e.viewportStore,o=e.participantStore,i=e.basemapStore,l=Object(a.useRef)(null),p=Object(a.useState)(null),m=Object(s.a)(p,2),h=m[0],f=m[1],y=Object(a.useState)(null),v=Object(s.a)(y,2),d=v[0],g=v[1],_=Object(a.useState)(null),O=Object(s.a)(_,2),S=O[0],w=O[1];Object(a.useEffect)((function(){var e=new b.Map({basemap:new b.Basemap({portalItem:{id:i.localState}})}),a=new b.views.MapView({map:e,container:l.current,center:[-30,26],zoom:3});a.when((function(){f(a)})).catch((function(e){return console.log(e)}));var r=N((function(e){var n=a.toMap({x:e.x,y:e.y}),r=n.longitude,o=n.latitude;t.setLocalState({x:r,y:o})}),50),o=a.on("pointer-move",r.callback),s=a.on("pointer-leave",(function(){r.cancel(),t.clearLocalState()}));a.ui.components=["zoom"];var c=N((function(e){var t={xmin:e.xmin,xmax:e.xmax,ymin:e.ymin,ymax:e.ymax};n.setLocalState(t)}),50),u=b.core.watchUtils.watch(a,"extent",c.callback),p=b.core.watchUtils.watch(a.map,"basemap",(function(){var e=a.map.basemap;i.setLocalState(e.portalItem.id)}));return function(){o.remove(),s.remove(),a.destroy(),e.destroy(),u.remove(),p.remove()}}),[]),Object(a.useEffect)((function(){if(h)if(null!==o.participantAction){var e=n.remoteStateMap.get(o.participantAction.participant.sessionId),t=i.remoteStateMap.get(o.participantAction.participant.sessionId);if(o.participantAction.actionType===Ie.PREVIEW&&null===d&&(g(h.extent.toJSON()),w(h.map.basemap)),e){var a=Object(c.a)(Object(c.a)({},e.value),{},{spatialReference:{wkid:102100}});h.extent=new b.geometry.Extent(a)}t&&h.map.basemap.portalItem.id!==t.value&&(h.map.basemap=new b.Basemap({portalItem:{id:t.value}}))}else{if(d){var r=Object(c.a)(Object(c.a)({},d),{},{spatialReference:{wkid:102100}});h.extent=new b.geometry.Extent(r),g(null)}S&&(h.map.basemap=S,w(null))}}),[o.participantAction,h,n.remoteState,i.remoteState]);var E=null!==h?r.a.createElement(r.a.Fragment,null,r.a.createElement(G,{position:t.localState}),r.a.createElement(Ve,{view:h}),r.a.createElement(De,{mapView:h}),r.a.createElement(Ae,{view:h}),r.a.createElement(qe,null),r.a.createElement(tt,null),r.a.createElement(rt,{map:h.map,sketches:xe.remoteState}),r.a.createElement(C,{map:h.map,pointers:t.remoteState})):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:u.a.mainMap,ref:l}),E)})),it=n(47),st=n.n(it),ct=function(e){var t=e.viewport,n=e.layer;return r.a.createElement(_,{layer:n,item:t,create:lt,update:function(e,t){t.geometry=new b.geometry.Extent(Object(c.a)(Object(c.a)({},e.value),{},{spatialReference:{wkid:102100}}))}})};function lt(e){var t=new b.geometry.Extent(Object(c.a)(Object(c.a)({},e.value),{},{spatialReference:{wkid:102100}})),n=S.getColor(e.user.userId.toGuid()),a=n.r,r=n.g,o=n.b,i=new b.symbols.SimpleFillSymbol({outline:{width:1,style:"solid",color:[a,r,o,.8]},color:[a,r,o,.15]});return new b.Graphic({geometry:t,symbol:i})}var ut=function(e){return r.a.createElement(k,{map:e.map,remoteItems:e.viewports,renderer:function(e,t){return r.a.createElement(ct,{key:e.sessionId,layer:t,viewport:e})}})},pt=Object(Ge.a)((function(){var e=Object(a.useRef)(null),t=Ce(),n=t.viewportStore,o=t.basemapStore,i=Object(a.useState)(!0),c=Object(s.a)(i,2),l=c[0],u=c[1],p=Object(a.useState)(null),m=Object(s.a)(p,2),h=m[0],f=m[1];Object(a.useEffect)((function(){var t=new b.Map({basemap:new b.Basemap({portalItem:{id:o.localState||"f81bc478e12c4f1691d0d7ab6361f5a6"}})}),n=new b.views.MapView({map:t,center:[-30,26],container:e.current});return n.ui.components=[],n.on("drag",(function(e){e.stopPropagation()})),n.on("key-down",(function(e){var t=e.key;-1!==["+","-","Shift","_","="].indexOf(t)&&e.stopPropagation()})),n.on("mouse-wheel",(function(e){e.stopPropagation()})),n.on("double-click",(function(e){e.stopPropagation()})),n.on("drag",["Shift"],(function(e){e.stopPropagation()})),n.on("drag",["Shift","Control"],(function(e){e.stopPropagation()})),n.when((function(){f(n)})),function(){n.destroy(),t.destroy()}}),[]),Object(a.useEffect)((function(){h&&(h.map.basemap=new b.Basemap({portalItem:{id:o.localState}}))}),[o.localState,h]);var y=null!==h?r.a.createElement(ut,{map:h.map,viewports:n.remoteState}):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:l?st.a.opened:st.a.closed},r.a.createElement("div",{className:st.a.map,ref:e}),r.a.createElement("div",{className:st.a.toggle,onClick:function(){u(!l)}},r.a.createElement("i",{className:st.a.arrow}))),y)})),mt=n(79),ht=n.n(mt),ft=n(59),yt=n.n(ft),vt=n(106),dt=(n(371),n(171)),bt=n(170),gt=n.n(bt),_t=function(){return r.a.createElement("div",{className:yt.a.titleBar},r.a.createElement(vt.a,{position:"top-center",autoClose:2500,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!1,draggable:!0,pauseOnHover:!0}),r.a.createElement("img",{className:yt.a.logo,src:ht.a,alt:"Convergence Logo"}),r.a.createElement("a",{className:yt.a.title,href:"https://convergence.io",target:"_blank",rel:"noopener noreferrer"},r.a.createElement("span",null,"Convergence Geo Sketch")),r.a.createElement("div",{className:yt.a.share},r.a.createElement("a",{href:"https://github.com/convergencelabs/geo-sketch-demo",target:"_blank",rel:"noopener noreferrer"},r.a.createElement("span",null,"Code ",r.a.createElement(Be.a,{icon:dt.a}))),r.a.createElement(gt.a,{text:window.location.href,onCopy:function(){vt.b.success("Share URL copied to clipboard!")}},r.a.createElement("span",null,"Share ",r.a.createElement(Be.a,{icon:Ue.i}))),r.a.createElement("span",{onClick:function(){window.open(window.location.href,"_blank")}},"New Window ",r.a.createElement(Be.a,{icon:Ue.c}))))},Ot=n(80),St=n.n(Ot),wt=n(48),Et=n.n(wt),jt=n(172),xt=n.n(jt),kt=n(49),Ct=n.n(kt),Nt=function(e){var t=e.user,n=e.linkedUser,a=e.onPreview,o=e.onGoto,i=e.onLink,s=e.onClear,c=S.getColorAsHex(t.user.userId.toGuid()),l=n?Ct.a.disabled:Ct.a.enabled,u=t===n?Ct.a.linked:l,p=t.local?t.user.displayName+" (you)":t.user.displayName,m=t.local?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(Be.a,{className:l,icon:Ue.e,size:"xs",onMouseEnter:function(){n||a(t)},onMouseLeave:function(){n||s()}}),r.a.createElement(Be.a,{className:l,icon:Ue.d,size:"xs",onClick:function(){n||o(t)}}),r.a.createElement(Be.a,{className:u,icon:Ue.h,size:"xs",onClick:function(){n===t?s():i(t)}}));return r.a.createElement("div",{className:Ct.a.presenceItem},r.a.createElement("span",{className:Ct.a.username,style:{borderColor:c}},p),m)},It=Object(Ge.a)((function(){var e,t=Ce().participantStore,n=function(e){t.setParticipantAction(Pe.preview(e))},a=function(e){t.setParticipantAction(Pe.goto(e)),setTimeout((function(){t.setParticipantAction(null)}),0)},o=function(e){t.setParticipantAction(Pe.link(e))},i=function(){t.setParticipantAction(null)},s=(null===(e=t.participantAction)||void 0===e?void 0:e.actionType)===Ie.LINK?t.participantAction.participant:null,c=Array.from(t.participants.values());c.sort((function(e){return e.local?-1:(e.user.displayName||"").localeCompare(e.user.displayName)}));var l=c.map((function(e){return r.a.createElement(Nt,{key:e.sessionId,user:e,linkedUser:s,onPreview:n,onGoto:a,onLink:o,onClear:i})}));return r.a.createElement("div",{className:xt.a.presenceList},l)})),At=n(173),Gt=n.n(At),Pt=n(105),Lt=n.n(Pt),Mt=n(50),Tt=n.n(Mt),Rt=n(174),Dt=n.n(Rt),Vt=function(e){var t=e.message,n=e.online,a=Dt()(t.timestamp).format("hh:mma"),o=n?{borderColor:S.getColorAsHex(t.user.userId.toGuid())}:{};return r.a.createElement("div",{className:Tt.a.chatMessage},r.a.createElement("div",{className:Tt.a.meta},r.a.createElement("span",{className:Tt.a.username,style:o},t.user.displayName),r.a.createElement("span",{className:Tt.a.timestamp},a)),r.a.createElement("div",{className:Tt.a.content},t.message))},Ft=Object(Ge.a)((function(){var e=Ce(),t=e.chatStore,n=e.participantStore,o=Object(a.useRef)(null),i=Object(a.useState)(0),c=Object(s.a)(i,2),l=c[0],u=c[1];Object(a.useEffect)((function(){if(l<t.messages.length){var e=o.current;e.scrollTop=e.scrollHeight-e.clientHeight,u(t.messages.length)}}),[t.messages.length,l]);var p=Array.from(n.participants.values()),m=t.messages.map((function(e){var t=void 0!==p.find((function(t){return t.user.userId.equals(e.user.userId)}));return r.a.createElement(Vt,{key:e.eventId,message:e,online:t})}));return r.a.createElement("div",{className:Lt.a.container,ref:o},r.a.createElement("div",{className:Lt.a.chatMessages},m))})),Kt=n(175),Ut=n.n(Kt),Bt=function(){var e=Ce().chatStore,t=Object(a.useRef)(null);return r.a.createElement("div",{className:Ut.a.chatInput},r.a.createElement("textarea",{placeholder:"Send Message",ref:t,onKeyDown:function(n){13!==n.keyCode||n.shiftKey||""===t.current.value||(e.sedMessage(t.current.value),t.current.value="",n.preventDefault())},rows:3}))},Jt=function(){return r.a.createElement("div",{className:Gt.a.chatPanel},r.a.createElement(Ft,null),r.a.createElement(Bt,null))},zt=n(176),Ht=n.n(zt),Wt=function(e){return r.a.createElement("div",{className:Ht.a.title},e.title)},qt=function(){var e=Object(a.useState)(!0),t=Object(s.a)(e,2),n=t[0],o=t[1];return r.a.createElement("div",{className:n?Et.a.sideBarOpen:Et.a.sideBarClosed},r.a.createElement("span",{className:Et.a.toggle,onClick:function(){return o(!n)}},r.a.createElement("span",{className:Et.a.toggleInner},r.a.createElement("span",{className:Et.a.arrow}))),r.a.createElement(Wt,{title:"Participants"}),r.a.createElement(It,null),r.a.createElement(Wt,{title:"Group Chat"}),r.a.createElement(Jt,null))},Qt=n(35),Xt=n.n(Qt),Yt=function(e){var t=Object(a.useState)(""),n=Object(s.a)(t,2),o=n[0],i=n[1];return r.a.createElement("div",{className:Xt.a.login},r.a.createElement("div",{className:Xt.a.title},r.a.createElement("img",{src:ht.a,alt:"Convergence Logo"}),r.a.createElement("span",{className:Xt.a.name},"Convergence Geo Sketch")),r.a.createElement("div",{className:Xt.a.form},r.a.createElement("label",{className:Xt.a.label},"Username"),r.a.createElement("input",{id:"username",value:o,onChange:function(e){i(e.target.value)}})),r.a.createElement("div",{className:Xt.a.note},"(Note: Any username will work!)"),r.a.createElement("div",{className:Xt.a.buttons},r.a.createElement("button",{className:Xt.a.button,disabled:""===o,onClick:function(){e.onLogin(o)}},"Login")))};if(void 0===GEO_SKETCH_DEMO_CONFIG)throw new Error("GEO_SKETCH_DEMO_CONFIG was not defined.");if(void 0===GEO_SKETCH_DEMO_CONFIG.domainUrl)throw new Error("CONVERGENCE_ADMIN_CONSOLE_CONFIG.restApiUrl was not defined.");var Zt=Object(c.a)({},GEO_SKETCH_DEMO_CONFIG);ne.i.configureLogging({root:ne.k.WARN});var $t=function(){function e(t,n){Object(f.a)(this,e),this.demoId=t,this.stores=n}return Object(y.a)(e,[{key:"connect",value:function(){var e=Object(h.a)(m.a.mark((function e(t){var n,a,r,o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.i.connectAnonymously(Zt.domainUrl,t);case 2:return n=e.sent,e.next=5,n.activities().join(this.demoId);case 5:return a=e.sent,this.stores.pointerStore.setActivity(a),this.stores.viewportStore.setActivity(a),this.stores.basemapStore.setActivity(a),this.stores.participantStore.setActivity(a),this.stores.sketchStore.setActivity(a),e.next=13,n.models().openAutoCreate({collection:"maps",id:this.demoId,data:function(){return{features:{}}},ephemeral:!0});case 13:return r=e.sent,this.stores.modelStore.setModel(r),e.next=17,n.chat().create({id:this.demoId,type:"room",membership:"public",ignoreExistsError:!0});case 17:return o=e.sent,e.next=20,n.chat().join(o);case 20:i=e.sent,this.stores.chatStore.setChatRoom(i);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),en=function(e){var t=Object(a.useState)(e.urlUsername),n=Object(s.a)(t,2),o=n[0],i=n[1],c=Object(a.useState)(!1),l=Object(s.a)(c,2),u=l[0],p=l[1],m=Object(a.useState)(),h=Object(s.a)(m,2),f=h[0],y=h[1],v=Ce(),d=Object(a.useState)(new $t(e.demoId,v)),b=Object(s.a)(d,1)[0];return Object(a.useEffect)((function(){null!==o&&b.connect(o).catch((function(e){y(e.message||"Unknown login error"),console.log(e)})).then((function(){p(!0)}))}),[o,b]),u?r.a.createElement("div",{className:St.a.GeoSketch},r.a.createElement(_t,null),r.a.createElement("div",{className:St.a.main},r.a.createElement("div",{className:St.a.map},r.a.createElement(ot,null),r.a.createElement(pt,null)),r.a.createElement(qt,null))):r.a.createElement(Yt,{onLogin:function(e){i(e)},error:f})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(375);var tn=new URL(window.location.href).searchParams.get("username"),nn=function(){var e=new URL(window.location.href),t=e.searchParams.get("id");return t||(t=Ne(),e.searchParams.append("id",t),window.history.pushState({},"",e.href)),t}();g.init().then((function(){i.a.render(r.a.createElement(en,{demoId:nn,urlUsername:tn}),document.getElementById("root"))})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},46:function(e,t,n){e.exports={picker:"styles_picker__1yrHC",swatch:"styles_swatch__3quun",color:"styles_color__2aFS8",popover:"styles_popover__2doJr",cover:"styles_cover__1_6vr"}},47:function(e,t,n){e.exports={opened:"styles_opened__3uJcd",map:"styles_map__36_lR",closed:"styles_closed__UWbQT",toggle:"styles_toggle__SSmfT",arrow:"styles_arrow__3ZLPF"}},48:function(e,t,n){e.exports={sideBarClosed:"styles_sideBarClosed__3VvnT",sideBarOpen:"styles_sideBarOpen__sz0xt",toggle:"styles_toggle__3MZQH",arrow:"styles_arrow__b1d5w"}},49:function(e,t,n){e.exports={presenceItem:"styles_presenceItem__1YiVl",username:"styles_username__354DQ",enabled:"styles_enabled__1a-Ym",linked:"styles_linked__31eKP",disabled:"styles_disabled__2Lp-H"}},50:function(e,t,n){e.exports={chatMessage:"styles_chatMessage__3FD2C",meta:"styles_meta__3jYrU",username:"styles_username__1Npjq",timestamp:"styles_timestamp__VKsQw",content:"styles_content__2uqgt"}},59:function(e,t,n){e.exports={titleBar:"styles_titleBar__3qreC",logo:"styles_logo__1-aij",title:"styles_title__3yLnz",share:"styles_share__EVFyq"}},79:function(e,t,n){e.exports=n.p+"static/media/logo.33ed6632.png"},80:function(e,t,n){e.exports={GeoSketch:"styles_GeoSketch__3bLLn",main:"styles_main__2TQA6",map:"styles_map__1N48Z"}}},[[177,1,2]]]);
//# sourceMappingURL=main.2718bdbb.chunk.js.map